# 2022-12

## 2022-12-01

https://github.com/ruanyl/vim-gh-line

よく使っているため内部を知っておきたいと思ったことと、サイズが小さそうなので気軽に読めそうだと思ったので読んでみた。

- `system()` で実行しているコマンドは全体的に参考になる
  - gitのサブコマンドとか知らなかったものが多い
- OSのチェック部分はベースラインにしてよいかも
- `if get(g:, "gh_open_command", "") == ""` でグローバル変数の存在チェック
- `<SID>` は `s:` と等価
- 一番気になっていた「HTTPSプロトコルでのリモートリポジトリのリンク取得部分」は、おおよそ自分が予想していたものと同じような泥臭いコードを書いていた
- `inputsave(), input(), inputrestore()` はユーザに入力を促す方法のベースラインと思っておく
- Vim scriptのテストの書き方とか実行方法を殆ど知らないので、テストスクリプトの書き方も参考になるかも知れない

https://github.com/tyru/capture.vim

一時バッファ（？）の使い方とかを知っておきたかった。

- プラグインの2重ロードを防ぐのは作法なんだなと思ったけど、記法の意味がよくわからなかった
  - https://vi.stackexchange.com/questions/15920/why-vim-plugins-have-a-check-on-cp
  - ということらしい
- バッファ書き込みの処理で呼ばれるようなVim script組み込み関数は押さえておきたい
  - `setline` とか、自分でちょっとしたプラグインを作るときもすぐ取り出せるようにしておきたい
- `setlocal buftype=nofile bufhidden=unload noswapfile nobuflisted` あたりでとりあえず使い捨てのバッファは生成できる？
- `= でVim scriptのインライン評価？みたいなことができるっぽい

## 2022-12-02

この日は飲み会だったのでおやすみ。

## 2022-12-03

https://github.com/junegunn/fzf

ちょっと大きいが、fzfが好きなので中でどういうことをしているか知っておきたい。

、、改めて思ったが、ドキュメントすらちゃんと読み切っていなかったので、まずはそこからスタートすることになってしまった。
エントリポイントから1つ下ったRun関数ぐらいはちょっと読んだけど、ほぼさっぱりだったため。

設定について調べ直していたら、せいぜいkey-bindingsのスクリプトを読む、ぐらいしかできなかった。

## 2022-12-04

https://github.com/glidenote/memolist.vim

日々とてもお世話になっているVimプラグイン。
全体のコードサイズも小さいのでとっつきやすそうと思ったので、読んでみる。

https://github.com/mattn/memo

その後はmattnさんのこちらも読みたい。

- `&undolevels` とかアンパサンドが頭につく記法が出てきたが、これはset対象のオプションの現在の設定値を取得している？
- `append` という関数がバッファに追記していく関数らしい
  - 名前が汎用的すぎて分かりづらい、、
- 「そういえば、memolistは初期のバッファは作成してくれるけど、明示的に保存処理をしないとファイルを作成してくれなかった」というのをコードを読みながら思い出した
  - 理由が知れてよかった
  - 初期のバッファを準備するにあたっては、設定値を上手く切り替えたりしているようだった

